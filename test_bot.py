#!/usr/bin/env python3
"""
–¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞
"""

from database import Database
from food_database import get_food_info, calculate_meal_nutrition, get_food_recommendations

def test_database():
    """–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö"""
    print("üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö...")
    
    db = Database()
    
    # –¢–µ—Å—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    db.add_user(12345, "test_user", "Test User")
    print("‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª–µ–Ω")
    
    # –¢–µ—Å—Ç –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    user = db.get_user(12345)
    print(f"‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–µ–Ω: {user[2]}")
    
    # –¢–µ—Å—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–µ–º–∞ –ø–∏—â–∏
    db.add_meal(12345, "–∑–∞–≤—Ç—Ä–∞–∫", "–æ–≤—Å—è–Ω–∫–∞", 389, 17, 66, 6.9)
    print("‚úÖ –ü—Ä–∏–µ–º –ø–∏—â–∏ –¥–æ–±–∞–≤–ª–µ–Ω")
    
    # –¢–µ—Å—Ç –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–∏–µ–º–æ–≤ –ø–∏—â–∏
    meals = db.get_daily_meals(12345)
    print(f"‚úÖ –ü–æ–ª—É—á–µ–Ω–æ –ø—Ä–∏–µ–º–æ–≤ –ø–∏—â–∏: {len(meals)}")
    
    # –¢–µ—Å—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤–æ–¥—ã
    db.add_water(12345, 500)
    print("‚úÖ –í–æ–¥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞")
    
    # –¢–µ—Å—Ç –ø–æ–ª—É—á–µ–Ω–∏—è –≤–æ–¥—ã
    water = db.get_daily_water(12345)
    print(f"‚úÖ –í—ã–ø–∏—Ç–æ –≤–æ–¥—ã: {water}–º–ª")
    
    # –¢–µ—Å—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤–µ—Å–∞
    db.add_weight(12345, 75.5)
    print("‚úÖ –í–µ—Å –¥–æ–±–∞–≤–ª–µ–Ω")
    
    # –¢–µ—Å—Ç –ø–æ–ª—É—á–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –≤–µ—Å–∞
    weight_history = db.get_weight_history(12345, 1)
    print(f"‚úÖ –ò—Å—Ç–æ—Ä–∏—è –≤–µ—Å–∞: {weight_history[0][0]}–∫–≥")
    
    print("üéâ –í—Å–µ —Ç–µ—Å—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–π–¥–µ–Ω—ã!")

def test_food_database():
    """–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –ø—Ä–æ–¥—É–∫—Ç–æ–≤"""
    print("\nüçé –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –ø—Ä–æ–¥—É–∫—Ç–æ–≤...")
    
    # –¢–µ—Å—Ç –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–æ–¥—É–∫—Ç–µ
    food_info = get_food_info("–æ–≤—Å—è–Ω–∫–∞")
    print(f"‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ–≤—Å—è–Ω–∫–µ: {food_info}")
    
    # –¢–µ—Å—Ç –ø–æ–¥—Å—á–µ—Ç–∞ –∫–∞–ª–æ—Ä–∏–π
    nutrition = calculate_meal_nutrition("–∫—É—Ä–∏—Ü–∞ –≥—Ä—É–¥–∫–∞", 150)
    print(f"‚úÖ –ü–∏—Ç–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫—É—Ä–∏–Ω–æ–π –≥—Ä—É–¥–∫–∏ (150–≥): {nutrition}")
    
    # –¢–µ—Å—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
    recommendations = get_food_recommendations()
    print(f"‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –±–µ–ª–∫–∏: {recommendations['recommended']['proteins'][:3]}")
    
    print("üéâ –í—Å–µ —Ç–µ—Å—Ç—ã –±–∞–∑—ã –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω—ã!")

def test_config():
    """–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏"""
    print("\n‚öôÔ∏è –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏...")
    
    try:
        from config import BOT_TOKEN, DEFAULT_CALORIES_GOAL, FOOD_CATEGORIES
        print(f"‚úÖ –¢–æ–∫–µ–Ω –±–æ—Ç–∞: {'–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω' if BOT_TOKEN else '–ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω'}")
        print(f"‚úÖ –¶–µ–ª—å –∫–∞–ª–æ—Ä–∏–π: {DEFAULT_CALORIES_GOAL}")
        print(f"‚úÖ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤: {len(FOOD_CATEGORIES)}")
        print("üéâ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!")
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏: {e}")

if __name__ == "__main__":
    print("üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Ñ–∏—Ç–Ω–µ—Å-–±–æ—Ç–∞...\n")
    
    try:
        test_config()
        test_database()
        test_food_database()
        
        print("\nüéâ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!")
        print("ü§ñ –ë–æ—Ç –≥–æ—Ç–æ–≤ –∫ –∑–∞–ø—É—Å–∫—É!")
        
    except Exception as e:
        print(f"\n‚ùå –û—à–∏–±–∫–∞ –≤–æ –≤—Ä–µ–º—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: {e}")
        print("üîß –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏")
